From 682286c1b6f584eeb8bc8e06957ef7fbb9356fb3 Mon Sep 17 00:00:00 2001
From: Guilhem Moulin <guilhem@debian.org>
Date: Fri, 5 Jun 2020 03:11:21 +0200
Subject: [PATCH 14/17] Make getnameinfo(3) errors non-fatal in report_sock()
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

report_sock() is used to show the peer's address/name and port when the
‘-v’ flag is set.  Reverse resolution errors need not be fatal.

Bug-Debian: https://bugs.debian.org/961378
---
 netcat.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/netcat.c b/netcat.c
index 7c44892..2690f9e 100644
--- a/netcat.c
+++ b/netcat.c
@@ -2230,9 +2230,11 @@ report_sock(const char *msg, const struct sockaddr *sa, socklen_t salen,
 	case 0:
 		break;
 	case EAI_SYSTEM:
-		err(1, "getnameinfo");
+		warn("getnameinfo");
+		return;
 	default:
-		errx(1, "getnameinfo: %s", gai_strerror(herr));
+		warnx("getnameinfo: %s", gai_strerror(herr));
+		return;
 	}
 
 	fprintf(stderr, "%s on %s %s\n", msg, host, port);
-- 
2.51.0

