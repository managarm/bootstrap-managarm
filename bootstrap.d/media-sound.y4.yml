!<tag:y4.managarm.org:preamble>
import:
  - !managarm
---
packages:
  - name: alsa-utils
    architecture: '@OPTION:arch@'
    metadata:
      summary: Advanced Linux Sound Architecture Utils
      description: This package contains the ALSA utilities.
      spdx: 'GPL-2-only'
      website: 'https://alsa-project.org/wiki/Main_Page'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['media-sound']
    source:
      subdir: 'ports'
      url: 'https://www.alsa-project.org/files/pub/utils/alsa-utils-1.2.13.tar.bz2'
      format: 'tar.bz2'
      checksum: blake2b:9bc2bf8e21fb9308c2eabc6612da0848f9ddba45acb8bf8453d9cff7f73fa0267495430a150ea53b28fab8afb69a51e487e8b253dc7501e17d77ea3f6e90bcf7
      extract_path: 'alsa-utils-1.2.13'
      version: '1.2.13'
      regenerate:
        - args: ['cp',
            '@BUILD_ROOT@/tools/host-automake-v1.15/share/automake-1.15/config.sub',
            '@THIS_SOURCE_DIR@']
        - args: ['cp',
            '@BUILD_ROOT@/tools/host-automake-v1.15/share/automake-1.15/config.guess',
            '@THIS_SOURCE_DIR@']
    tools_required:
      - system-gcc
      - host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
    pkgs_required:
      - mlibc
      - alsa-lib
      - ncurses
    revision: 1
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--disable-alsaconf'
        - '--disable-maintainer-mode'
        - '--with-asound-state-dir=/var/lib/alsa'
        - '--with-udev-rules-dir=/etc/udev/rules.d'
        - '--disable-xmlto'
        environ:
          CFLAGS: '-Wno-implicit-function-declaration'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
