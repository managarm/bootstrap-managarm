sources:
  - name: libxtrans
    subdir: ports
    git: 'https://gitlab.freedesktop.org/xorg/lib/libxtrans.git'
    tag: 'xtrans-1.5.0'
    version: '1.5.0'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.11
      - host-libtool
      - host-pkg-config
      - host-xorg-macros
    regenerate:
      - args: ['./autogen.sh']
        environ:
          'NOCONFIGURE': 'yes'

tools:
  - name: host-xtrans
    labels: [aarch64]
    architecture: noarch
    exports_aclocal: true
    from_source: libxtrans
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--prefix=@PREFIX@'
    compile:
      - args: ['make', '-j@PARALLELISM@']
    install:
      - args: ['make', 'install']

packages:
  - name: cairo
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: 'ports'
      git: 'https://gitlab.freedesktop.org/cairo/cairo.git'
      tag: '1.17.6'
      version: '1.17.6'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-libtool
      - host-pkg-config
    pkgs_required:
      - mlibc
      - freetype
      - fontconfig
      - libpng
      - pixman
      - libxcb
      - libx11
      - libxext
      - mesa
      - libxrender
      - glib
    revision: 9
    configure:
      - args:
        # For now, we build without glesv2 backend as Weston prefers the image backend.
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        - '--enable-xlib-xcb'
        - '--enable-xml'
        - '--enable-tee'
        - '--enable-gl'
        environ:
          # freetype-config does not support cross-compilation.
          FREETYPE_CONFIG: 'no'
          PKG_CONFIG_SYSROOT_DIR: '@BUILD_ROOT@/system-root'
          PKG_CONFIG_LIBDIR: '@BUILD_ROOT@/system-root/usr/lib/pkgconfig:@BUILD_ROOT@/system-root/usr/share/pkgconfig'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
        quiet: true

  - name: gdk-pixbuf
    architecture: '@OPTION:arch@'
    metadata:
      summary: Toolkit for image loading and pixel buffer manipulation
      description: This package provides a toolkit for image loading and pixel buffer manipulation.
      spdx: 'LGPL-2.1'
      website: 'https://download.gnome.org/sources/gdk-pixbuf-xlib/'
      maintainer: "Alexander Richards <electrodeyt@gmail.com>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.gnome.org/GNOME/gdk-pixbuf.git'
      tag: '2.42.11'
      version: '2.42.11'
    tools_required:
      - system-gcc
      - host-libtool
      - host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
      - host-mlibc
      - host-gobject-introspection
      - host-python
      - host-glib
    pkgs_required:
      - mlibc
      - glib
      - libjpeg-turbo
      - libpng
      - shared-mime-info
      - libx11
      - gobject-introspection
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '-Dintrospection=enabled'
        - '-Dman=false'
        - '-Dgtk_doc=false'
        - '-Ddocs=false'
        - '@THIS_SOURCE_DIR@'
        environ:
          # Same as below
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
    build:
      - args: ['ninja']
        environ:
          # Library path for our run-wrapper that allows it to load managarm libraries
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          # Similar to above, but using a nasty (but working) hack lets us use a Linux mlibc build to execute an
          # executable that was cross-compiled for managarm
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
          # This is a custom environment variable which tells g-ir-scanner what to use instead of ldd
          # We point it at our native ldd-wrapper that's installed as part of host-gobject-introspection
          GI_LDD_WRAPPER: ldd-wrapper
          # This tells g-ir-scanner what program should be used for "cross-launching" the executables it builds
          GI_CROSS_LAUNCHER: run-wrapper
          # Path to the introspection data installed by other packages
          GI_GIR_PATH: '@SYSROOT_DIR@/usr/share/gir-1.0'
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: ['gdk-pixbuf-query-loaders', '--update-cache']

  - name: gdk-pixbuf-xlib
    architecture: '@OPTION:arch@'
    metadata:
      summary: GDK pixbuf xlib interface
      description: This package provides a deprecated Xlib interface to gdk-pixbuf, which is needed for some applications which have not been ported to use the new interfaces yet.
      spdx: 'LGPL-2.1'
      website: 'https://download.gnome.org/sources/gdk-pixbuf-xlib/'
      maintainer: "Alexander Richards <electrodeyt@gmail.com>"
      categories: ['x11-libs']
    source:
      subdir: 'ports'
      url: 'https://download.gnome.org/sources/gdk-pixbuf-xlib/2.40/gdk-pixbuf-xlib-2.40.2.tar.xz'
      format: 'tar.xz'
      checksum: blake2b:a515e86bc69f59910f61fe9c275ab89c0732f0aa2cfb614ac94e597de420d25708a11b9b21313c7cfe3763434f45a8318412ae5889c24c8ed57dac68e09c0227
      extract_path: 'gdk-pixbuf-xlib-2.40.2'
      patch-path-strip: 1
      version: '2.40.2'
    tools_required:
      - system-gcc
      - host-libtool
      - host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
    pkgs_required:
      - mlibc
      - gdk-pixbuf
      - libx11
    revision: 6
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
    scripts:
        post_install:
          - args: ['gdk-pixbuf-query-loaders', '--update-cache']

  # Deprecated, please don't depend on this anymore. Only here for gtklife and hexchat.
  - name: gtk+-2
    architecture: '@OPTION:arch@'
    source:
      subdir: 'ports'
      url: 'https://download.gnome.org/sources/gtk+/2.24/gtk+-2.24.32.tar.xz'
      format: 'tar.xz'
      checksum: blake2b:03f4c0a8be98473f62bc8c86859937969c4169960a5f93d37ff6dcde00413215fa6c7125b15781bf50d67b40aa0056cb71b83fb50acb2c3467b5deb3c8d938f0
      extract_path: 'gtk+-2.24.32'
      patch-path-strip: 1
      version: '2.24.32'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-glib
      regenerate:
        - args: ['autoreconf', '-fvi']
    tools_required:
      - system-gcc
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
    pkgs_required:
      - mlibc
      - atk
      - cairo
      - glib
      - gdk-pixbuf
      - libx11
      - libxext
      - libxcb
      - pango
      - hicolor-icon-theme
    revision: 12
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        - '--disable-gtk-doc-html'
        - '--disable-cups'
        - '--disable-papi'
        - '--disable-introspection'
        - '--disable-glibtest'
        - '--disable-test-print-backend'
        - '--enable-xkb'
        environ:
          ac_cv_func_getresuid: 'no'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
        quiet: true
      # Rename a file to avoid conflicts, we will use gtk3 as default, so rename this one.
      - args: ['mv', '-v', '@THIS_COLLECT_DIR@/usr/bin/gtk-update-icon-cache', '@THIS_COLLECT_DIR@/usr/bin/gtk2-update-icon-cache']
    scripts:
        post_install:
          - args: ['gtk-query-immodules-2.0', '--update-cache']
          - args: ['glib-compile-schemas', '/usr/share/glib-2.0/schemas']

  - name: gtk+-3
    architecture: '@OPTION:arch@'
    source:
      subdir: 'ports'
      git: 'https://gitlab.gnome.org/GNOME/gtk.git'
      tag: '3.24.38'
      version: '3.24.38'
    tools_required:
      - system-gcc
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
      - wayland-scanner
      - host-glib
      - host-mlibc
      - host-gobject-introspection
      - host-python
    pkgs_required:
      - mlibc
      - at-spi2-core
      - cairo
      - glib
      - gdk-pixbuf
      - libx11
      - libxext
      - libxcb
      - libxrender
      - libxrandr
      - libxfixes
      - libxdamage
      - pango
      - fribidi
      - libepoxy
      - libxkbcommon
      - wayland
      - wayland-protocols
      - fontconfig
      - freetype
      - libxi
      - harfbuzz
      - libxcursor
      - gsettings-desktop-schemas
      - dbus
      - libxinerama
    revision: 7
    configure:
      - args:
        - 'meson'
        - 'setup'
        - '--native-file'
        - '@SOURCE_ROOT@/scripts/meson.native-file'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '--libdir=lib'
        - '--buildtype=debugoptimized'
        - '-Dprint_backends=file'
        - '-Dintrospection=false' # Gobject introspection is broken again
        - '-Dx11_backend=true'
        - '-Dbroadway_backend=true'
        - '-Dwayland_backend=true'
        - '-Dgtk_doc=false'
        - '-Dcolord=no'
        - '@THIS_SOURCE_DIR@'
        environ:
          # Same as below
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
    build:
      - args: ['ninja']
        environ:
          # Library path for our run-wrapper that allows it to load managarm libraries
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          # Similar to above, but using a nasty (but working) hack lets us use a Linux mlibc build to execute an
          # executable that was cross-compiled for managarm
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
          # This is a custom environment variable which tells g-ir-scanner what to use instead of ldd
          # We point it at our native ldd-wrapper that's installed as part of host-gobject-introspection
          GI_LDD_WRAPPER: ldd-wrapper
          # This tells g-ir-scanner what program should be used for "cross-launching" the executables it builds
          GI_CROSS_LAUNCHER: run-wrapper
          # Path to the introspection data installed by other packages
          GI_GIR_PATH: '@SYSROOT_DIR@/usr/share/gir-1.0'
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
          # Library path for our run-wrapper that allows it to load managarm libraries
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          # Similar to above, but using a nasty (but working) hack lets us use a Linux mlibc build to execute an
          # executable that was cross-compiled for managarm
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
          # This is a custom environment variable which tells g-ir-scanner what to use instead of ldd
          # We point it at our native ldd-wrapper that's installed as part of host-gobject-introspection
          GI_LDD_WRAPPER: ldd-wrapper
          # This tells g-ir-scanner what program should be used for "cross-launching" the executables it builds
          GI_CROSS_LAUNCHER: run-wrapper
          # Path to the introspection data installed by other packages
          GI_GIR_PATH: '@SYSROOT_DIR@/usr/share/gir-1.0'
    scripts:
        post_install:
          - args: ['gtk-query-immodules-3.0', '--update-cache']
          - args: ['glib-compile-schemas', '/usr/share/glib-2.0/schemas']

  - name: libdmx
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org dmx library
      description: This package contains the X.Org dmx library.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libdmx'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libdmx.git'
      tag: 'libdmx-1.1.5'
      version: '1.1.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libdrm
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org libdrm library
      description: Libdrm provides a userspace library for accessing the direct rendering manager (DRM) on operating systems that support the ioctl interface. Libdrm is a low-level library, typically used by graphics drivers such as the Mesa DRI drivers, the X drivers, libva and similar projects.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/mesa/drm'
      maintainer: "no92 <leo@managarm.org>"
      categories: ['dev-libs']
    source:
      subdir: 'ports'
      git: 'https://gitlab.freedesktop.org/mesa/drm'
      tag: 'libdrm-2.4.115'
      version: '2.4.115'
    tools_required:
      - system-gcc
    pkgs_required:
      - mlibc
    revision: 8
    configure:
      - args:
        - 'meson'
        - '--native-file'
        - '@SOURCE_ROOT@/scripts/meson.native-file'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '--libdir=lib'
        - '--buildtype=debugoptimized'
        - '-Dintel=disabled'
        - '-Dvmwgfx=disabled'
        - '-Dradeon=disabled'
        - '-Damdgpu=disabled'
        - '-Dnouveau=disabled'
        - '-Dfreedreno=disabled'
        - '-Detnaviv=disabled'
        - '-Dvc4=disabled'
        # We might want to build cairo with OpenGL support.
        # Doing so would introduce a circular dependency here.
        - '-Dcairo-tests=disabled'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
        quiet: true

  - name: libfontenc
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libfontenc.git'
      tag: 'libfontenc-1.1.7'
      version: '1.1.7'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xorg-font-util
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - xorg-font-util
      - zlib
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libice
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libice.git'
      tag: 'libICE-1.1.1'
      version: '1.1.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libsm
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libsm.git'
      tag: 'libSM-1.2.4'
      version: '1.2.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libice
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libx11
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org X11 library
      description: This package provides the core X11 library.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libX11'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libx11.git'
      tag: 'libX11-1.8.7'
      version: '1.8.7'
      tools_required:
        - host-autoconf-v2.71
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxcb
      - libxtrans
    revision: 4
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-ipv6'
        - '--disable-malloc0returnsnull'
        - '--with-keysymdefdir=@SYSROOT_DIR@/usr/include/X11'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxau
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxau.git'
      tag: 'libXau-1.0.11'
      version: '1.0.11'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxaw
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxaw.git'
      tag: 'libXaw-1.0.15'
      version: '1.0.15'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxt
      - libxmu
      - libxpm
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcb
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    metadata:
      summary: X C-language Bindings library
      description: The libxcb package provides an interface to the X Window System protocol, which replaces the current Xlib interface. Xlib can also use XCB as a transport layer, allowing software to make requests and receive responses with both.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libxcb'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb.git'
      tag: 'libxcb-1.16'
      version: '1.16'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxau
      - libxdmcp
      - xcb-proto
    revision: 4
    configure:
      - args: ['sed', '-i', "s/pthread-stubs//", '@THIS_SOURCE_DIR@/configure']
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
        environ:
          PYTHON: 'python3'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcomposite
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org Xcomposite library
      description: This package contains the X.Org Xcomposite library.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libxcomposite'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcomposite.git'
      tag: 'libXcomposite-0.4.6'
      version: '0.4.6'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxfixes
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcursor
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcursor.git'
      tag: 'libXcursor-1.2.1'
      version: '1.2.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxfixes
      - libxrender
    revision: 7
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxdamage
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxdamage.git'
      tag: 'libXdamage-1.1.6'
      version: '1.1.6'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxfixes
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxdmcp
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxdmcp.git'
      tag: 'libXdmcp-1.1.4'
      version: '1.1.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libxau
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxext
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxext.git'
      tag: 'libXext-1.3.5'
      version: '1.3.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxfixes
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxfixes.git'
      tag: 'libXfixes-6.0.1'
      version: '6.0.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxfont2
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxfont.git'
      tag: 'libXfont2-2.0.6'
      version: '2.0.6'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-xtrans
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - freetype
      - fontconfig
      - bzip2
      - libfontenc
      - zlib
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-bzip2'
        - '--disable-devel-docs'
        # strcasecmp is implicitly declared, probably an missing include somewhere, so disable -Werror for that
        - '--disable-selective-werror'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxft
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxft.git'
      tag: 'libXft-2.3.8'
      version: '2.3.8'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxrender
      - freetype
      - fontconfig
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxi
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxi.git'
      tag: 'libXi-1.8.1'
      version: '1.8.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
      - libxfixes
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxinerama
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org Xinerama library
      description: This package contains the X.Org Xinerama library.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libXinerama'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libXinerama.git'
      tag: 'libXinerama-1.1.5'
      version: '1.1.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxkbcommon
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: 'ports'
      git: 'https://github.com/xkbcommon/libxkbcommon.git'
      tag: 'xkbcommon-1.5.0'
      version: '1.5.0'
    tools_required:
      - host-pkg-config
      - system-gcc
      - wayland-scanner
      - virtual: pkgconfig-for-host
        program_name: host-pkg-config
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
    pkgs_required:
      - mlibc
      - wayland
      - wayland-protocols
      - libxcb
      - libxml
      - xkeyboard-config
    revision: 6
    configure:
      - args:
        - 'meson'
        - '--native-file'
        - '@SOURCE_ROOT@/scripts/meson.native-file'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '--libdir=lib'
        - '--buildtype=debugoptimized'
        - '-Denable-docs=false'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
        quiet: true

  - name: libxkbfile
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxkbfile.git'
      tag: 'libxkbfile-1.1.2'
      version: '1.1.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxmu
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxmu.git'
      tag: 'libXmu-1.1.4'
      version: '1.1.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxtrans
      - libxt
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxpm
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxpm.git'
      tag: 'libXpm-3.5.16'
      version: '3.5.16'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
      - libxt
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxrandr
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxrandr.git'
      tag: 'libXrandr-1.5.4'
      version: '1.5.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxrender
      - libxext
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxrender
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxrender.git'
      tag: 'libXrender-0.9.11'
      version: '0.9.11'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxres
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org XRres library
      description: This package contains the X.Org XRes library.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libXres'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libXres.git'
      tag: 'libXres-1.2.2'
      version: '1.2.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxscrnsaver
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org XScrnSaver library
      description: This package contains the X.Org ScreenSaver library.
      spdx: 'MIT'
      website: 'https://gitlab.freedesktop.org/xorg/lib/libxscrnsaver'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxscrnsaver.git'
      tag: 'libXScrnSaver-1.2.4'
      version: '1.2.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
        - host-xtrans
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxext
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxshmfence
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxshmfence.git'
      tag: 'libxshmfence-1.3.2'
      version: '1.3.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-futex'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxt
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxt.git'
      tag: 'libXt-1.3.0'
      version: '1.3.0'
      tools_required:
        - host-autoconf-v2.71
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.71
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libsm
      - libice
    revision: 10
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
        - '--with-appdefaultdir=/etc/X11/app-defaults'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxtrans
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    from_source: libxtrans
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - xorg-util-macros
      - xorg-proto
      - libxcb
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxtst
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxtst.git'
      tag: 'libXtst-1.2.4'
      version: '1.2.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
      - libxi
    revision: 7
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxxf86dga
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxxf86dga.git'
      tag: 'libXxf86dga-1.1.6'
      version: '1.1.6'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxxf86vm
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxxf86vm.git'
      tag: 'libXxf86vm-1.1.5'
      version: '1.1.5'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
    revision: 7
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--disable-malloc0returnsnull'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: pango
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    metadata:
      summary: Internationalized text layout and rendering library
      description: Pango is a library for laying out and rendering text, with an emphasis on internationalization. It can be used anywhere that text layout is needed, though most of the work on Pango so far has been done in the context of the GTK+ widget toolkit.
      spdx: 'LGPL-2.0-or-later'
      website: 'https://gitlab.gnome.org/GNOME/pango'
      maintainer: "Dennis Bonke <dennis@managarm.org>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.gnome.org/GNOME/pango.git'
      tag: '1.51.1'
      version: '1.51.1'
    tools_required:
      - host-pkg-config
      - system-gcc
      - host-glib
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
      - host-mlibc
      - host-gobject-introspection
      - host-python
    pkgs_required:
      - mlibc
      - glib
      - fontconfig
      - freetype
      - fribidi
      - cairo
      - xorg-proto
      - libx11
      - libxtrans
      - libxext
      - harfbuzz
      - libxft
      - pcre
    revision: 5
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '--buildtype=release'
        - '-Dintrospection=enabled'
        - '--wrap-mode=nofallback'
        - '@THIS_SOURCE_DIR@'
        environ:
          # Same as below
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
    build:
      - args: ['ninja']
        environ:
          # Library path for our run-wrapper that allows it to load managarm libraries
          RUN_WRAPPER_LD_LIBRARY_PATH: '@BUILD_ROOT@/tools/host-mlibc/lib:@SYSROOT_DIR@/usr/lib:@SYSROOT_DIR@/usr/lib64:@THIS_BUILD_DIR@/girepository'
          # Similar to above, but using a nasty (but working) hack lets us use a Linux mlibc build to execute an
          # executable that was cross-compiled for managarm
          RUN_WRAPPER_INTERP: '@BUILD_ROOT@/tools/host-mlibc/lib/ld.so'
          # This is a custom environment variable which tells g-ir-scanner what to use instead of ldd
          # We point it at our native ldd-wrapper that's installed as part of host-gobject-introspection
          GI_LDD_WRAPPER: ldd-wrapper
          # This tells g-ir-scanner what program should be used for "cross-launching" the executables it builds
          GI_CROSS_LAUNCHER: run-wrapper
          # Path to the introspection data installed by other packages
          GI_GIR_PATH: '@SYSROOT_DIR@/usr/share/gir-1.0'
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: pixman
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: 'ports'
      git: 'https://gitlab.freedesktop.org/pixman/pixman.git'
      tag: 'pixman-0.42.2'
      version: '0.42.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
      regenerate:
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-libtool
      - host-pkg-config
      - system-gcc
    pkgs_required:
      - mlibc
      - libpng
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--with-sysroot=@SYSROOT_DIR@' # Set libtool's lt_sysroot.
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
        quiet: true

  - name: xcb-util
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-util.git'
      tag: 'xcb-util-0.4.1'
      version: '0.4.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
          isolate_network: false
        - args: ['./autogen.sh']
          environ:
            'NOCONFIGURE': 'yes'
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - xorg-util-macros
      - xorg-proto
      - libx11
      - libxtrans
      - libxcb
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xcb-util-cursor
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-cursor.git'
      tag: 'xcb-util-cursor-0.1.4'
      version: '0.1.4'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
          isolate_network: false
        - args: ['autoreconf', '-fvi']
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
    pkgs_required:
      - mlibc
      - libxcb
      - xcb-util-image
      - xcb-util-render-util
      - xorg-proto
      - xcb-util
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xcb-util-image
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-image.git'
      tag: 'xcb-util-image-0.4.1'
      version: '0.4.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
          isolate_network: false
        - args: ['autoreconf', '-fvi']
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - libxcb
      - xorg-util-macros
      - xorg-proto
      - xcb-util
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xcb-util-keysyms
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-keysyms.git'
      tag: 'xcb-util-keysyms-0.4.1'
      version: '0.4.1'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
          isolate_network: false
        - args: ['autoreconf', '-fvi']
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - libxcb
      - xorg-util-macros
      - xorg-proto
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xcb-util-render-util
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-render-util.git'
      tag: 'xcb-util-renderutil-0.3.10'
      version: '0.3.10'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
          isolate_network: false
        - args: ['autoreconf', '-fvi']
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - libxcb
      - xorg-util-macros
      - xorg-proto
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: xcb-util-wm
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcb-wm.git'
      tag: 'xcb-util-wm-0.4.2'
      version: '0.4.2'
      tools_required:
        - host-autoconf-v2.69
        - host-automake-v1.15
        - host-libtool
        - host-pkg-config
        - host-xorg-macros
        - host-autoconf-archive
      regenerate:
        - args: ['git', 'submodule', 'update', '--init']
          isolate_network: false
        - args: ['autoreconf', '-fvi']
    tools_required:
      - system-gcc
      - host-autoconf-v2.69
      - host-automake-v1.15
      - host-pkg-config
    pkgs_required:
      - mlibc
      - libxcb
      - xorg-util-macros
      - xorg-proto
    revision: 6
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--sysconfdir=/etc'
        - '--localstatedir=/var'
        - '--disable-static'
        - '--without-doxygen'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libxcvt
    labels: [aarch64]
    architecture: '@OPTION:arch@'
    metadata:
      summary: X.Org xcvt library and cvt program
      description: VESA CVT standard timing modeline generation library & utility.
      spdx: 'MIT'
      website: 'https://wayland.freedesktop.org/xserver.html'
      maintainer: "no92 <no92.mail@gmail.com>"
      categories: ['x11-libs']
    source:
      subdir: ports
      git: 'https://gitlab.freedesktop.org/xorg/lib/libxcvt.git'
      tag: 'libxcvt-0.1.2'
      version: '0.1.2'
    tools_required:
      - system-gcc
      - host-pkg-config
    pkgs_required:
      - mlibc
    revision: 7
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'
